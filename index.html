<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Echoes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
  <div class="card shadow">
    <div class="card-body">
      <h2 class="card-title text-center mb-4">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à Echoes</h2>

      <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ -->
      <div class="mb-3">
        <label for="priceMode" class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</label>
        <select id="priceMode" class="form-select">
          <option value="preorder">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</option>
          <option value="normal">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ï‡∏¥‡∏°</option>
        </select>
      </div>

      <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì -->
      <div class="mb-3">
        <label for="modeSelect" class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</label>
        <select id="modeSelect" class="form-select">
          <option value="buttons">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°</option>
          <option value="topup">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô</option>
          <option value="budget">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
          <option value="discount">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="echoesInput" class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏° / ‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏° / ‡∏á‡∏ö)</label>
        <input type="number" id="echoesInput" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô 833 ‡∏´‡∏£‡∏∑‡∏≠ 1759 ‡∏´‡∏£‡∏∑‡∏≠ 1000">
      </div>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏î‡∏µ‡∏¢‡∏ß -->
      <button class="btn btn-primary w-100" onclick="calculate()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>

      <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÅ‡∏ö‡∏ö dynamic -->
      <div id="discountFormContainer" class="mt-3" style="display:none;">
        <form id="discountForm">
          <div id="discountRows"></div>
          <button type="button" class="btn btn-secondary mt-2" onclick="addRow()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á</button>
        </form>
      </div>

      <div class="mt-4">
        <h5>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</h5>
        <div id="result" class="bg-white p-3 border rounded"></div>
      </div>
    </div>
  </div>
</div>

<script>
  const echoTopup = { 66: 60, 203: 185, 335: 305, 759: 690, 2227: 2025, 3663: 3330, 7249: 6590 };

  // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Normal)
const normalPrices = {
  66: 35,
  203: 105,
  335: 150,
  759: 340
};

// ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏£‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Preorder)
const preorderPrices = {
  66: 30,
  203: 85,
  335: 140,
  759: 280
};


  // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (Discount Table)
  const discountTable = {
    normal: {
      66:   { p3: 31,  p10: 29 },
      203:  { p3: 88,  p10: 82 },
      335:  { p3: 146, p10: 140 },
      759:  { p3: 295, p10: 275 },
      2227: { p3: 880, p10: 820 },
      3663: { p3: 1460, p10: 1370 },
      7249: { p3: 2920, p10: 2740 }
    },
    preorder: {
      66:   { p3: 29,  p10: 27 },
      203:  { p3: 82,  p10: 77 },
      335:  { p3: 135, p10: 125 },
      759:  { p3: 272, p10: 252 },
      2227: { p3: 820, p10: 760 },
      3663: { p3: 1360, p10: 1260 },
      7249: { p3: 2620, p10: 2430 }
    }
  };

  function getPriceTable(priceMode) {
    return priceMode === "preorder" ? preorderPrices : normalPrices;
  }

  function resetDiscountForm() {
    document.getElementById("discountRows").innerHTML = "";
    rowCount = 0;
  }


// ===== ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á dropdown dynamic =====
const packs = [66, 203, 335, 759, 2227, 3663, 7249];
const discounts = ["none", "3", "10"];

function createRow(index) {
  return `
    <div class="row mb-2" id="row-${index}">
      <div class="col-md-6">
        <select class="form-select" id="pack-${index}">
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å --</option>
          ${packs.map(p => `<option value="${p}">${p}</option>`).join("")}
        </select>
      </div>
      <div class="col-md-6">
        <select class="form-select" id="discount-${index}">
          <option value="none">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</option>
          <option value="3">3%</option>
          <option value="10">10%</option>
        </select>
      </div>
    </div>
  `;
}

let rowCount = 0;
function addRow() {
  rowCount++;
  document.getElementById("discountRows").insertAdjacentHTML("beforeend", createRow(rowCount));
}

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏°‡∏µ 5 ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤
for (let i = 0; i < 5; i++) {
  addRow();
}



 function applyDiscounts() {
  let totalPrice = 0, totalEchoes = 0, totalTopup = 0, totalPacks = 0;
  let rows = "";

  // ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® priceMode ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
  let priceMode = document.getElementById("priceMode").value;

  document.querySelectorAll("#discountRows .row").forEach(row => {
    let index = row.id.split("-")[1];
    let pack = parseInt(document.getElementById(`pack-${index}`).value);
    let choice = document.getElementById(`discount-${index}`).value;

    if (!pack) return;

    let basePrice = getPriceTable(priceMode)[pack] || 0;
    let finalPrice = basePrice;

    if (choice === "3") finalPrice = discountTable[priceMode][pack].p3;
    else if (choice === "10") finalPrice = discountTable[priceMode][pack].p10;

    totalPrice += finalPrice;
    totalEchoes += pack;
    totalTopup += (echoTopup[pack] || 0);
    totalPacks += 1;

    rows += `<tr><td>${pack}</td><td>${basePrice}</td><td>${finalPrice}</td></tr>`;
  });

  let html = "<table class='table table-bordered'><thead><tr><th>‡πÅ‡∏û‡πá‡∏Å</th><th>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥</th><th>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</th></tr></thead><tbody>";
  html += rows + "</tbody></table>";
  html += `<p>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤: ${totalPrice} ‡∏ö‡∏≤‡∏ó</p>`;
  html += `<p>‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏£‡∏ß‡∏°: ${totalEchoes}</p>`;
  html += `<p>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏£‡∏ß‡∏°: ${totalTopup}</p>`;
  html += `<p>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ: ${totalPacks}</p>`;
  document.getElementById("result").innerHTML = html;
}


  
  // ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å =====
  function calculate() {
  let mode = document.getElementById("modeSelect").value;
  let priceMode = document.getElementById("priceMode").value;

  if (mode === "buttons") {
    document.getElementById("discountFormContainer").style.display = "none";
    resetDiscountForm();
    calculateButtons(priceMode);
  } else if (mode === "topup") {
    document.getElementById("discountFormContainer").style.display = "none";
    resetDiscountForm();
    calculateTopup(priceMode);
  } else if (mode === "budget") {
    document.getElementById("discountFormContainer").style.display = "none";
    resetDiscountForm();
    calculateBudget(priceMode);
  } else if (mode === "discount") {
    document.getElementById("discountFormContainer").style.display = "block";

    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á 5 ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    if (rowCount === 0) {
        for (let i = 0; i < 5; i++) {
            addRow();
        }
    }

    applyDiscounts();
}

  



  }

  // 
  function calculateButtons() {
  let needed = parseInt(document.getElementById("echoesInput").value);
  if (isNaN(needed) || needed <= 0) {
    document.getElementById("result").innerText = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    return;
  }
  // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà echoes >= needed
  let options = generateOptions("buttons", needed).filter(o => o.echoes >= needed);
  options.sort((a,b) => a.price - b.price);
  let best = options[0];
  document.getElementById("result").innerHTML = `
    <p>‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ${best.desc}</p>
    <p>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${best.echoes} ‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°</p>
    <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°: ${best.price} ‡∏ö‡∏≤‡∏ó</p>
    <p>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏£‡∏ß‡∏°: ${best.topup}</p>`;
}


 function calculateTopup() {
  let neededTopup = parseInt(document.getElementById("echoesInput").value);
  if (isNaN(neededTopup) || neededTopup <= 0) {
    document.getElementById("result").innerText = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    return;
  }
  // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà topup >= neededTopup
  let options = generateOptions("topup", neededTopup).filter(o => o.topup >= neededTopup);
  options.sort((a,b) => a.price - b.price);
  let best = options[0];
  document.getElementById("result").innerHTML = `
    <p>‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ${best.desc}</p>
    <p>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${best.echoes} ‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°</p>
    <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°: ${best.price} ‡∏ö‡∏≤‡∏ó</p>
    <p>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏£‡∏ß‡∏°: ${best.topup}</p>`;
}

  function calculateBudget() {
  let budget = parseInt(document.getElementById("echoesInput").value);
  if (isNaN(budget) || budget <= 0) {
    document.getElementById("result").innerText = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    return;
  }

  let options = generateOptions("budget", budget);

  // ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°
  let lower = options.filter(o => o.price < budget)
                     .sort((a,b) => (budget - a.price) - (budget - b.price))[0];
  let equal = options.reduce((best,o) =>
    Math.abs(o.price - budget) < Math.abs((best?.price || 0) - budget) ? o : best, null);
  let higher = options.filter(o => o.price > budget)
                      .sort((a,b) => (a.price - budget) - (b.price - budget))[0];

  // ‡∏ñ‡πâ‡∏≤ lower ‡∏Å‡∏±‡∏ö equal ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ equal ‡πÅ‡∏•‡∏∞ higher
  let showLower = lower && (!equal || lower.price !== equal.price);

  let html = "<table class='table table-bordered'><thead><tr><th>‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th><th>‡∏™‡∏π‡∏ï‡∏£</th><th>‡∏£‡∏≤‡∏Ñ‡∏≤</th><th>‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏£‡∏ß‡∏°</th><th>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô</th></tr></thead><tbody>";
  if (showLower) html += `<tr><td>‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤</td><td>${lower.desc}</td><td>${lower.price} ‡∏ö‡∏≤‡∏ó</td><td>${lower.echoes}</td><td>${lower.topup}</td></tr>`;
  if (equal) html += `<tr><td>‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á/‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö</td><td>${equal.desc}</td><td>${equal.price} ‡∏ö‡∏≤‡∏ó</td><td>${equal.echoes}</td><td>${equal.topup}</td></tr>`;
  if (higher) html += `<tr><td>‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</td><td>${higher.desc}</td><td>${higher.price} ‡∏ö‡∏≤‡∏ó</td><td>${higher.echoes}</td><td>${higher.topup}</td></tr>`;
  html += "</tbody></table>";

  document.getElementById("result").innerHTML = html;
}

  
function generateOptions(mode, target, priceMode) {
  let priceTable = getPriceTable(priceMode);
  let options = [];

  // ‡πÉ‡∏ä‡πâ‡πÅ‡∏û‡πá‡∏Å‡∏ï‡∏≤‡∏°‡πÇ‡∏´‡∏°‡∏î
  let usablePacks = (mode === "discount") 
    ? [66, 203, 335, 759, 2227, 3663, 7249] 
    : [66, 203, 335, 759];

  // ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤
  let max66 = 2;   // 66 ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2
  let max203 = 1;  // 203 ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1
  let max335 = 1;  // 335 ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1
  let max759 = Math.floor(target / 759) + 5; // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏û‡πá‡∏Å‡πÉ‡∏´‡∏ç‡πà

  for (let c66 = 0; c66 <= max66; c66++) {
    for (let c203 = 0; c203 <= max203; c203++) {
      for (let c335 = 0; c335 <= max335; c335++) {
        for (let c759 = 0; c759 <= max759; c759++) {
          let echoes = c66*66 + c203*203 + c335*335 + c759*759;
          let topup = c66*(echoTopup[66]||0) + c203*(echoTopup[203]||0) + c335*(echoTopup[335]||0) + c759*(echoTopup[759]||0);

          // ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏û‡πá‡∏Å 759
          let price759 = priceTable[759] || 0;
          if (c759 >= 25) {
            price759 = 275;
          } else if (c759 >= 15) {
            price759 = 278;
          }

          let price = c66*(priceTable[66]||0) + c203*(priceTable[203]||0) + c335*(priceTable[335]||0) + c759*price759;

          // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° desc ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö
          let descParts = [];
          if (c759 > 0) descParts.push(`759x${c759}`);
          if (c335 > 0) descParts.push(`335x${c335}`);
          if (c203 > 0) descParts.push(`203x${c203}`);
          if (c66 > 0) descParts.push(`66x${c66}`);
          let desc = descParts.join(" ");

          if (!desc) continue;

          // üîé ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤
          let isValid = true;

          // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏Ñ‡∏≤ >= ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏û‡πá‡∏Å 759 ‡πÅ‡∏ï‡πà echoes <= 759 ‚Üí ‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°
          if (price >= (priceTable[759]||0) && echoes <= 759) {
            isValid = false;
          }

          // ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô 335+203+66x2 ‚Üí ‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö 759
          if (c335 === 1 && c203 === 1 && c66 === 2 && c759 === 0) {
            isValid = false;
          }

          if (!isValid) continue;

          // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ options ‡∏ï‡∏≤‡∏°‡πÇ‡∏´‡∏°‡∏î
          if (mode === "buttons" && echoes >= target) {
            options.push({desc, echoes, topup, price});
          }
          if (mode === "topup" && topup >= target) {
            options.push({desc, echoes, topup, price});
          }
          if (mode === "budget") {
            options.push({desc, echoes, topup, price});
          }
          if (mode === "discount") {
            options.push({desc, echoes, topup, price});
          }
        }
      }
    }
  }

  return options;
}



</script>
</body>
</html>









